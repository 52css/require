(function(win,undefined){var $=function(){function isArrayLike(obj){if(obj&&typeof obj==="object"&&!$.isWindow(obj)){var n=obj.length;if(+n===n&&!(n%1)&&n>=0){try{if({}.propertyIsEnumerable.call(obj,"length")===false){return Array.isArray(obj)||/^\s?function/.test(obj.item||obj.callee)}return true}catch(e){return true}}}return false}var class2type={"[object Boolean]":"Boolean","[object Number]":"Number","[object String]":"String","[object Function]":"Function","[object Array]":"Array","[object Date]":"Date","[object RegExp]":"RegExp","[object Window]":"Window","[object Document]":"Document","[object Arguments]":"Arguments","[object NodeList]":"NodeList","[object HTMLDocument]":"Document","[object HTMLCollection]":"NodeList","[object StaticNodeList]":"NodeList","[object DOMWindow]":"Window","[object global]":"Window","null":"Null",NaN:"NaN",undefined:"Undefined"},serialize=class2type.toString,slice=[].slice,hasOwnProperty={}.hasOwnProperty,toString={}.toString,$={each:function(obj,fn,args){if(obj){var ol=obj.length,i,val,fnHasOwnProperty={}.hasOwnProperty;if(args){if(isArrayLike(obj))for(i=0;i<ol;i++)if(fn.apply(obj,args)===false)break;else for(i in obj)if(fnHasOwnProperty.call(obj,i))fn.apply(obj,args)}else{if(isArrayLike(obj))for(i=0;i<ol;i++){val=obj[i];if(fn.call(val,i,val)===false)break}else for(i in obj)if(fnHasOwnProperty.call(obj,i))fn.call(obj,i,obj[i])}}},extend:function(){var arg=arguments,argLen=arg.length,obj,i=1,isDeep,mixin=function(obj1,obj,isDeep){obj=obj||{};$.each(obj1,function(p,v){obj[p]=obj[p]||{};if(isDeep&&$.type(v)==="object"){mixin(v,obj[p],isDeep)}else{obj[p]=v}});return obj};if(arg[0]===true){i=2;isDeep=1;obj=arg[1]}else{obj=argLen===1?this:arg[0]}for(;i<argLen;i++){mixin(arg[i],obj,isDeep)}return obj},grep:function(arr,callback,invert){if($.type(arr)==="array"){var a=[],b=[];$.each(arr,function(i,n){callback.call(n,n,i)?a.push(n):b.push(n)});return invert?b:a}},makeArray:function(object){var ret=[];if(object!==null){var i=object.length;if(i===null||object.split||object.setInterval||object.call){ret[0]=object}else{while(i)ret[--i]=object[i]}}return ret},map:function(arr,callback){if($.type(arr)==="array"){var rtv=[];$.each(arr,function(i,n){var arrRtv=callback.call(n,n);if(arrRtv){rtv=Array.prototype.concat.call(rtv,arrRtv)}});return rtv}},inArray:function(val,arr,index){for(var i=index||0,len=arr.length;i<len;i++){if(val===arr[i]){return i}}return-1},merge:function(first,second){},unique:function(arr){var rtv=[],obj={};$.each(arr,function(i,n){if(!obj[n]){obj[n]=true;rtv.push(n)}});return rtv},noop:function(){},isArray:function(obj){return $.type(obj)==="array"},isFunction:function(obj){return $.type(obj)==="function"},isEmptyObject:function(obj){for(var p in obj){if(p){return false}}return true},isPlainObject:function(obj){if(!obj||toString.call(obj)!=="[object Object]"||obj.nodeType||obj.setInterval){return false}if(obj.constructor&&!hasOwnProperty.call(obj,"constructor")&&!hasOwnProperty.call(obj.constructor.prototype,"isPrototypeOf")){return false}var key;for(key in obj){}return key===undefined||hasOwnProperty.call(obj,key)},isWindow:function(obj){return obj.window&&obj.window===obj.window.window},isNullOrUndefined:function(obj){return obj==undefined},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){var result=class2type[$.isNullOrUndefined(obj)||obj!==obj?obj:serialize.call(obj)]||obj.nodeName||"#";if(result.charAt(0)==="#"){if(obj==obj.document&&obj.document!=obj){result="Window"}else if(obj.nodeType===9){result="Document"}else if(obj.callee){result="Arguments"}else if(isFinite(obj.length)&&obj.item){result="NodeList"}else{result=serialize.call(obj).slice(8,-1)}}return result.toLowerCase()},trim:function(str){if($.type(str)==="string"){return String.prototype.trim?str.trim():str.replace(/^s+|s+$/g,"")}}};$.extend($,{isJSON:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return true}else{return false}},log:function(){try{if(console&&console.log){return console.log.apply(console,arguments)}}catch(ex){}},Ajaxs:function(){return function(){var ajaxs=[],ends=[],loadIndex=0,fnEnd=function(){if(ajaxs.end&&$.type(ajaxs.end)==="function"){ajaxs.end();$.each(ends,function(i,fn){fn()});ajaxs.isEnd=true}};ajaxs.add=function(fn){ajaxs.push(fn)};ajaxs.fire=function(star,end){if(star&&$.type(star)==="function"){star()}ajaxs.end=end;if(ajaxs.length){$.each(ajaxs,function(i,fn){if(fn&&$.type(fn)==="function"){fn()}})}else{fnEnd()}};ajaxs.onEnd=function(fn){if(ajaxs.isEnd){fn()}else{ends.push(fn)}};ajaxs.ok=function(obj,key,val){if(obj&&key){if($.type(key)==="object"){obj=$.extend(obj,key)}else if(val){obj[key]=val}}loadIndex+=1;if(ajaxs.length===loadIndex){fnEnd()}};return ajaxs}}(),ready:function(){var dom=[];dom.isReady=false;dom.ready=function(fn){if(dom.isReady){fn()}else{dom.push(fn)}};dom.fireReady=function(){if(!dom.isReady){if(!document.body){return setTimeout(dom.fireReady,16)}dom.isReady=1;if(dom.length){for(var i=0,fn;fn=dom[i];i++)fn()}}};if(document.readyState==="complete"){dom.fireReady()}else if(-[1]){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);dom.fireReady()},false)}else{document.attachEvent("onreadystatechange",function(){if(document.readyState=="complete"){document.detachEvent("onreadystatechange",arguments.callee);dom.fireReady()}});(function(){if(dom.isReady){return}var node=new Image;try{node.doScroll();node=null}catch(e){setTimeout(arguments.callee,64);return}dom.fireReady()})()}return dom.ready}()});return $}(),_=function(){var defineMap={},defineEventMap={},REQUIRE_RE=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,SLASH_RE=/\\\\/g,head=document.head||document.getElementsByTagName("head")[0],parseDeps=function(code){var ret=[];code.replace(SLASH_RE,"").replace(REQUIRE_RE,function(m,m1,m2){if(m2){ret.push(m2)}});return ret},canGetCurrentScript=true,fnCurrentScript=function(all,isLast){var stack,url,nodes=(all?document:head).getElementsByTagName("script");if(canGetCurrentScript){if(document.currentScript){return document.currentScript}try{throw new Error}catch(e){stack=e.stack;if(!stack&&window.opera){stack=(String(e).match(/of linked script \S+/g)||[]).join(" ")}}if(stack){stack=stack.split(/[@ ]/g).pop();stack=stack[0]=="("?stack.slice(1,-1):stack;url=stack.replace(/(:\d+)?:\d+$/i,"")}if(nodes.length){if(typeof url==="string"&&url){for(var i=0,node;node=nodes[i++];){if(node.src===url){return node}}}for(var i=0,node;node=nodes[i++];){if(node.readyState==="interactive"){return node}}canGetCurrentScript=false;return nodes[nodes.length-1]}}else{return nodes[nodes.length-1]}},reUrl=/^\w+:\/\/.+/,getCurrentScriptSrc=function(all,isLast){var script=fnCurrentScript(all,isLast);if(script&&script.src){var src=script.src;return reUrl.test(src)?src:script.getAttribute("src",4)}},fnAbsolutePath=function(relativePath,base){if($.isNullOrUndefined(relativePath))return;var absolutePath;var DOT_RE=/\/\.\//g;var DOUBLE_DOT_RE=/\/[^/]+\/\.\.\//;var DOUBLE_SLASH_RE=/([^:/])\/\//g;if(reUrl.test(relativePath)){return relativePath}if($.isNullOrUndefined(base)){base=location.href}base=base.split("#")[0].split("/").slice(0,-1).join("/")+"/";absolutePath=(base+relativePath).replace(DOT_RE,"/");while(absolutePath.match(DOUBLE_DOT_RE)){absolutePath=absolutePath.replace(DOUBLE_DOT_RE,"/")}absolutePath=absolutePath.replace(DOUBLE_SLASH_RE,"$1/");if(!/\.(css|js)$/.test(absolutePath)){absolutePath+=".js"}return absolutePath},fnLoadScript=function(src,callback){if(!reUrl.test(src))return;var script=document.createElement("script");script.type="text/javascript";if(callback)script.onload=script.onreadystatechange=function(){if(script.readyState&&script.readyState!="loaded"&&script.readyState!="complete")return;script.onreadystatechange=script.onload=null;callback.call(script)};$.log("load script: "+src);script.src=src;document.body.appendChild(script)},fnLoadCss=function(src,callback){if(!reUrl.test(src))return;var link=document.createElement("link");link.setAttribute("rel","stylesheet");link.setAttribute("type","text/css");link.setAttribute("href",src);head.appendChild(link);function styleOnload(node,callback){if(!callback)return;if(node.attachEvent){node.attachEvent("onload",callback)}else{setTimeout(function(){poll(node,callback)},0)}}function poll(node,callback){if(callback.isCalled){return}var isLoaded=false;if(/webkit/i.test(navigator.userAgent)){if(node["sheet"]){isLoaded=true}}else if(node["sheet"]){try{if(node["sheet"].cssRules){isLoaded=true}}catch(ex){if(ex.code===1e3){isLoaded=true}}}if(isLoaded){setTimeout(function(){callback.call(node)},1)}else{setTimeout(function(){poll(node,callback)},1)}}styleOnload(link,callback)},fnLoad=function(src,callback){if(!reUrl.test(src))return;var ext;if(/\.(css|js)$/.test(src)){ext=RegExp.$1}switch(ext){case"css":fnLoadCss(src,function(){if($.type(callback)==="function"){callback()}});break;case"js":fnLoadScript(src,callback);break}},fnLoads=function(urls,isOrder){var len=urls.length,i=0;function fnInnerLoad(){if(aLoads.length){fnLoad(aLoads[0],function(){aLoads.shift();fnInnerLoad()})}}if(isOrder){$.ready(function(){if(aLoads.length){aLoads=aLoads.concat(urls)}else{aLoads=urls;fnInnerLoad()}})}else{for(;i<len;i++){fnLoad(urls[i])}}},aLoads=[],commonConfig={alias:{}},_={init:function(){var requireScript=fnCurrentScript(true),requireSrc=getCurrentScriptSrc(true),requireMain;$.extend(win,{require:$.extend(_.require,{version:"0.0.4",config:function(obj){obj.base=fnAbsolutePath(obj.base);$.extend(commonConfig,obj)}}),define:$.extend(_.define,{defineMap:defineMap})});requireMain=requireScript.getAttribute("data-main");if(requireMain){$.each(requireMain.split(","),function(i,n){_.require(fnAbsolutePath(n,requireSrc))})}},require:function(deps,factory){if(arguments.length===1&&$.type(deps)==="function"){$.ready(deps);return}var newLoad=new $.Ajaxs,requireList=[],id;id=commonConfig.base||getCurrentScriptSrc(true,true);console.log(getCurrentScriptSrc());deps=$.makeArray(deps);if($.type(factory)==="function"){deps=deps.concat(parseDeps(factory.toString()))}$.each($.unique(deps),function(i,dep){dep=fnAbsolutePath(dep,id);if(!defineEventMap[dep]){defineEventMap[dep]=new $.Ajaxs;requireList.push(dep)}newLoad.add(function(){defineEventMap[dep].onEnd(function(){newLoad.ok()})})});if(requireList&&requireList.length){fnLoads(requireList,!canGetCurrentScript)}newLoad.fire(function(){},function(){var params=[];$.each(deps,function(i,dep){dep=fnAbsolutePath(dep,id);params.push(defineMap[dep].exports)});factory.apply(null,params)})},define:function(id,deps,factory){var defineList=[],currentScriptSrc=getCurrentScriptSrc(true);switch(arguments.length){case 1:factory=id;id=currentScriptSrc;deps=[];break;case 2:if($.type(id)==="string"){factory=deps;deps=[];id=fnAbsolutePath(id,currentScriptSrc)}else{factory=deps;deps=id;id=currentScriptSrc}break}if($.type(factory)==="function"){deps=deps.concat(parseDeps(factory.toString()))}defineMap[id]={id:id,deps:deps,factory:factory};if(!defineEventMap[id]){defineEventMap[id]=new $.Ajaxs}$.each($.unique(deps),function(i,dep){dep=fnAbsolutePath(dep,id);if(!defineEventMap[dep]){defineEventMap[dep]=new $.Ajaxs;defineList.push(dep)}defineEventMap[id].add(function(){defineEventMap[dep].onEnd(function(){defineEventMap[id].ok()})})});if(defineList&&defineList.length){fnLoads(defineList,!canGetCurrentScript)}defineEventMap[id].fire(function(){},function(){var module=defineMap[id];module.exports={};var localRequire=function(dep){dep=fnAbsolutePath(dep,id);return defineMap[dep].exports};module.exports=$.type(factory)==="function"?factory(localRequire,module.exports,module)||module.exports:factory})}};return _}();_.init()})(window);